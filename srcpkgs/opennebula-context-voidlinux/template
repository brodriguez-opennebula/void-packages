# Template file for 'opennebula-context-voidlinux'
pkgname=opennebula-context-voidlinux
version=0.0.2
revision=1
build_style=gnu-makefile
depends="curl jq qemu-ga ruby"
short_desc="Contextualization scripts for opennebula"
maintainer="brodriguez <brodriguez@opennebula.io>"
license="Apache-2.0"
homepage="https://github.com/brodriguez-opennebula/opennebula-context-voidlinux"
distfiles="${homepage}/archive/refs/tags/${version}.tar.gz"
checksum=d5f46e318fb1d01cf70d2868bf3528646021d4e6f12440955853a38a747b4314

do_build() {
	make install
}

do_install() {
	vinstall /usr/bin/onesysprep 540 /usr/bin
	vinstall /usr/bin/growpart 540 /usr/bin
	vinstall /usr/bin/one-contextd 540 /usr/bin
	vinstall /usr/bin/onegate.rb 540 /usr/bin
	vinstall /usr/bin/onegate 540 /usr/bin

	vmkdir /etc/one-context.d
	vcopy /etc/one-context.d/* /etc/one-context.d
	vinstall /usr/lib/udev/rules.d/65-context.rules 0444 usr/lib/udev/rules.d/
	vinstall /etc/sv/one-contextd/run 0544 etc/sv/one-contextd
	vinstall /etc/sv/one-contextd/log/run 0544 etc/sv/one-contextd/log

	vmkdir usr/share/doc/${pkgname}
	vcopy ${FILESDIR}/README.voidlinux usr/share/doc/${pkgname}/README.voidlinux

}
